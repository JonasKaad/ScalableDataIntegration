@using SkyPanel.Components.Models
@inject IJSRuntime JS
@inject ISnackbar Snackbar
@if (_blobDataItems == null)
{
    <MudProgressCircular Color="Color.Default" Indeterminate="true" />
}
else
{
    <MudTable Items="_blobDataItems" Hover="true" SortLabel="Sort By" Elevation="0" AllowUnsorted="false">
        <HeaderContent>
            <MudTh><MudTableSortLabel SortBy="new Func<Dataset, object>(x=>x.Parser!)">Parser</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<BlobDataItem, object>(x=>x.Date)">Date</MudTableSortLabel></MudTh>
            <MudTh/>
            <MudTh/>
            <MudTh/>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="Parser">@context.Parser</MudTd>
            <MudTd DataLabel="Date">@context.Date.ToString("dd/MM/yyyy HH\\:mm")</MudTd>
            <MudTd DataLabel="Download Raw">
                <MudTooltip Text="Raw dataset not found" Disabled="@(!string.IsNullOrEmpty(context.RawPath))" Arrow="true">
                    <MudButton StartIcon="@Icons.Material.Filled.Download" Variant="Variant.Outlined" Color="Color.Info" Disabled="@(string.IsNullOrEmpty(context.RawPath))" OnClick="@(() => Download(@context.Parser, @context.RawPath))">Raw</MudButton>
                </MudTooltip>
            </MudTd>
            <MudTd DataLabel="Download Parsed">
                <MudTooltip Text="Parsed dataset not found" Disabled="@(!string.IsNullOrEmpty(context.ParsedPath))" Arrow="true">
                    <MudButton StartIcon="@Icons.Material.Filled.Download" Variant="Variant.Outlined" Color="Color.Primary" Disabled="@(string.IsNullOrEmpty(context.ParsedPath))" OnClick="@(() => Download(@context.Parser, @context.ParsedPath))">Parsed</MudButton>
                </MudTooltip>
            </MudTd>
            <MudTd DataLabel="Delete Dataset"><MudButton StartIcon="@Icons.Material.Filled.Delete" Variant="Variant.Outlined" Color="Color.Error">Delete</MudButton></MudTd>
        </RowTemplate>
        <PagerContent>
            <MudTablePager PageSizeOptions="new []{5, 10}" />
        </PagerContent>
    </MudTable>
}